#:import Factory kivy.factory.Factory

<MainScreenView>:
    RelativeLayout:
        canvas.before:
            Color:
                rgba: (128, 0, 128, 0.5)
            Rectangle:
                size: self.size
                pos: self.pos
        Label:
            text: "String Art"
            size_hint: None, None
            size: self.texture_size
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}

        BoxLayout:
            orientation: 'horizontal'
            size: root.width, root.height
            padding: 20
            spacing: 20

            MDRectangleFlatButton:
                id: button_input_image
                text: 'Import image'
                size_hint: 3, None
                md_bg_color: (10/255, 100/255, 10/255, 1)
                text_color: (1, 1, 1, 1)
                radius: [20]
                on_release:
                    Factory.SelectImagePins(root.return_controller(), root.return_model()).open()

            MDRectangleFlatButton:
                text: ':'
                md_bg_color: (10/255, 100/255, 10/255, 1)
                text_color: (1, 1, 1, 1)
                radius: [20]
                #on_release:
                    #root.print_h()

            MDRectangleFlatButton:
                id: button_open_project
                text: 'Ð¡ontinue the project'
                md_bg_color: (10/255, 100/255, 10/255, 1)
                size_hint: 3, None
                text_color: (1, 1, 1, 1)
                radius: [20]
                on_release:
                    Factory.SelectProject(root.return_controller(), root.return_model()).open()

<SelectImagePins>:
    title: 'Select an image and an number pins'
    size_hint: .8, .9

    MDBoxLayout:
        orientation: 'vertical'
        padding: '20dp'

        FileChooserIconView:
            id: filechooser
            on_selection: root.model.selected_file = filechooser.selection
            size_hint: 1, 10
        MDLabel:
            text: 'Number pins: ' + str(int(slider_pins_id.value))
            color: (1, 1, 1, 1)
            halign: "center"
            size_hint: 1, 1
        MDSlider:
            id: slider_pins_id
            max: 300
            min: 100
            value:200
            size_hint: 1, 1
        MDLabel:
            text: 'Number lines: ' + str(int(slider_lines_id.value))
            color: (1, 1, 1, 1)
            halign: "center"
            size_hint: 1, 1
        MDSlider:
            id: slider_lines_id
            max: 4000
            min: 1000
            value:2000
            size_hint: 1, 1
        MDLabel:
            text: 'Pixel brightness: ' + str(int(slider_pins_id.value))
            color: (1, 1, 1, 1)
            halign: "center"
            size_hint: 1, 1
        MDSlider:
            id: slider_thread_id
            max: 100
            min: 0
            value: 50
            size_hint: 1, 1
        MDRectangleFlatButton:
            id: btn_ok
            text: 'OK'
            md_bg_color: (10/255, 100/255, 10/255, 1)
            text_color: (1, 1, 1, 1)
            radius: [20]
            size_hint: 1, None
            on_release:
                root.generate_file(int(slider_pins_id.value), int(slider_lines_id.value), int(slider_thread_id.value))
                root.dismiss()
                root.controller.switch_screen('view screen')
                #Factory.ProgressGenerateImage().open()

<SelectProject>:
    title: 'Select file an project'
    size_hint: .8, .9

    MDBoxLayout:
        orientation: 'vertical'
        padding: '20dp'

        FileChooserIconView:
            id: filechooser
            on_selection: root.model.selected_file = filechooser.selection
            size_hint: 1, 10

        MDRectangleFlatButton:
            id: btn_ok
            text: 'OK'
            md_bg_color: (10/255, 100/255, 10/255, 1)
            text_color: (1, 1, 1, 1)
            radius: [20]
            size_hint: 1, None
            on_release:
                root.open_project()
                root.dismiss()
                root.controller.switch_screen('view screen')